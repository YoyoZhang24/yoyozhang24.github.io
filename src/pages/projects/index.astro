---
import { getCollection } from "astro:content";
import Main from "@/layouts/Main.astro";
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import ProjectCard from "@/components/ProjectCard.astro";
import { SITE } from "@/config";

const projects = await getCollection("projects");
const sortedProjects = projects.sort((a, b) => {
  const dateA = a.data.pubDatetime
    ? new Date(a.data.pubDatetime).getTime()
    : 0;
  const dateB = b.data.pubDatetime
    ? new Date(b.data.pubDatetime).getTime()
    : 0;
  return dateB - dateA;
});
---

<Layout title={`Projects | ${SITE.title}`}>
  <Header />
  <Main pageTitle="Projects" pageDesc="Try out some of the projects I've built!">
    {sortedProjects.length > 0 ? (
      <ul>
        {sortedProjects.map((project) => (
          <ProjectCard {project} />
        ))}
      </ul>
    ) : (
      <p class="text-muted">No projects yet. Check back soon!</p>
    )}
  </Main>
  <Footer />
</Layout>